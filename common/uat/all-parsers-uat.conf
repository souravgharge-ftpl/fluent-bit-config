[PARSER]
    Name                connecthub_firstline_parser
    Format              regex
    Regex               ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)\sstdout\sF\s\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2},\d{3}\s+\|\s+\[rId:(?<rId>[^\]]*)\]\s+\|\s+\[tId:(?<tId>[^\]]*)\](?:\s+\|\s+\[fId:(?<fId>[^\]]*)\])?\s+\|\s+(?<level>[A-Z]+)\s+\|\s+\[(?<class>[^\]]+)\]\s+\|\s+\((?<thread>[^\)]+)\)\s+\|\s+(?<message>.*)$
    Time_Key            timestamp
    Time_Format         %Y-%m-%dT%H:%M:%S.%LZ

[PARSER]
    Name                connecthub_continuation_parser
    Format              regex
    Regex               ^(?<message_continuation>\s+at\s.*|\s+.*)$

[PARSER]
    Name                connecthub_karaf_firstline
    Format              regex
    Regex               ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)\s+stdout\s+F\s+[\d:.]+\s+(?<level>[A-Z]+)\s+\[(?<context>[^\]]+)\]\s+(?<message>.*)$
    Time_Key            timestamp
    Time_Format         %Y-%m-%dT%H:%M:%S.%LZ

[PARSER]
    Name                connecthub_karaf_continuation
    Format              regex
    Regex               ^(?!\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)(?<message>.*)$ 

# Parser for basic log format (timestamp, level, classname, thread, message)
[PARSER]
    Name                quarkus_log_parser
    Format              regex
    Regex               ^(?<timestamp>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3}) \| (?<level>[A-Z]+) \| (?<classname>[\w\.]+) \| \((?<thread>[\w\-]+)\) \| (?<message>.*)$
    Time_Key            timestamp
    Time_Format         %Y-%m-%d %H:%M:%S.%L

[PARSER]
    Name                prism_multiline
    Format              regex
    Regex               ^(?<time>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{9}Z)\sstdout\sF\s\d{2}:\d{2}:\d{2}\s+(?<level>[A-Z]+)\s+\[(?<classname>[^\]]+)\]{1,2}\s+\((?<thread>[^\)]+)\)\s+(?<message>(?:.|\n\s+at\s.*)*)
    Multiline           On
    Flush_Interval      10

[PARSER]
    Name                vllm_log_parser
    Format              regex
    Regex               ^(?<level>[A-Z]+):?\s+(?<timestamp>\d{2}-\d{2} \d{2}:\d{2}:\d{2})?\s*(?:\[(?<source>[^\]]+)\]\s*)?(?<message>.*)$
    Time_Key            timestamp
    Time_Format         %m-%d %H:%M:%S

[PARSER]
    Name                prism_log_parser
    Format              regex
    Regex               ^(?<time>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{9}Z)\sstdout\sF\s\d{2}:\d{2}:\d{2}\s+(?<level>[A-Z]+)\s+\[(?<classname>[^\]]+)\]{1,2}\s+\((?<thread>[^\)]+)\)\s+(?<message>.*)$
    Time_Key            timestamp
    Time_Format         %H:%M:%S

# Simple JSON parser for parsing JSON content from message field
[PARSER]
    Name                json_parser
    Format              json

# JSON parser for the "message" field to extract structured JSON data
[PARSER]
    Name                json_log_parser
    Format              json
    Time_Key            timestamp
    Time_Format         %Y-%m-%d %H:%M:%S.%L

[PARSER]
    Name   unified_parser
    Format regex
    Regex  ^(?<prefix>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z\s+stdout\s+F\s+)(?<timestamp>\d{2}:\d{2}:\d{2}\.\d{3})\s+(?<level>\w+)\s+\[(?<thread>[^\]]+)\]\s+(?<message>.*?)(?<throwable>(?:\n.*)*)?$
    Time_Key timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Decode_Field_As json message

[PARSER]
    Name                risk_gauge_multiline
    Format              regex
    Multiline           On
    Flush_Interval      5
    # Match the first line of a log or stack trace
    Regex               ^(?<time>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)\s+stdout\s+F\s+\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2}\.\d+\s+(?<level>[A-Z]+)\s+\[(?<thread>[^\]]+)\]\s+\[rId:(?<rid>[^\]]*)\]\s+(?<class>\S+)\s+(?<message>.*)
    Time_Key            time
    Time_Format         %Y-%m-%dT%H:%M:%S.%LZ

[PARSER]
    Name                finsense_firstline
    Format              regex
    #Regex               ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)\s+stdout\s+F\s+\d{2}:\d{2}:\d{2}\.\d{3}\s+(?<level>[A-Z]+)\s+\[(?<context>[^\]]+)\]\s+(?!OpenTelemetry Message)(?<message>.*)$
    Regex               ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)\s+stdout\s+F\s+.*?\s+(?<level>[A-Z]+).*?\[(?<context>[^\]]+)\]\s+(?<message>.*)$
    Time_Key            timestamp
    Time_Format         %Y-%m-%dT%H:%M:%S.%LZ

[PARSER]
    Name                finsense_continuation
    Format              regex
    Regex               ^(?!\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)(?<message>.*)$
