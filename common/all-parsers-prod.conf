[PARSER]
    Name custom_parser
    Format regex
    Regex ^(?:\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d*Z)\sstdout\sF\s(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z)\s+(?<level>[A-Z]+)\s(?<pid>\d+)\s---\s\[(?<thread>[^\]]+)\]\s+\[\s*(?<context>[^\]]+)\]\s+(?<class>[^\s]+)\s+:\s(?<message>.*(?:\n\s+at\s.*)*)

[PARSER]
    Name finsense_pattern
    Format regex
    Regex ^(?<log_timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)\s+stdout\s+F\s+(?<time>\d{2}:\d{2}:\d{2}\.\d{3})\s+(?<level>\w+)\s+\[(?<context>[^\]]+)\]\s+(?<message>.*)$
    Time_Key timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Decode_Field_As json message

[PARSER]
    Name pfm_log_parser
    Format regex
    Regex     [PARSER]
    Name custom_log_parser
    Format regex
    Regex ^(?P<timestamp>\S+T\S+Z)\s+(?P<level>[A-Z]+)\s+(?P<log_code>\d+)\s---\s\[(?P<thread_name>[^\]]+)\]\s\[(?P<thread_id>[^\]]+)\]\s(?P<logger_name>[^\s]+)\s*:\s(?P<message>.*)$

# JSON Parser for payload in the message field (optional)
[PARSER]
    Name json_payload_parser
    Format json

[PARSER]
    Name                finsense_java_multiline
    Format              regex
    Regex               ^(?<log_timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)\s+stdout\s+F\s+(?<time>\d{2}:\d{2}:\d{2}\.\d{3})\s+(?<level>\w+)\s+\[(?<context>[^\]]+)\]\s+(?<message>.*)$
    Flush_Timeout 1

[PARSER]
    Name          connecthub_karaf_firstline
    Format        regex
    Regex         ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)\s+stdout\s+F\s+[\d:.]+\s+(?<level>[A-Z]+)\s+\[(?<context>[^\]]+)\]\s+(?<message>.*)$
    Time_Key      timestamp
    Time_Format   %Y-%m-%dT%H:%M:%S.%LZ

[PARSER]
    Name          connecthub_karaf_continuation
    Format        regex
    Regex         ^(?!\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)(?<message>.*)$

[PARSER]
    Name   opentelemetry_parser
    Format regex
    Regex  ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2},\d{3}) \| (?<level>[A-Z]+) \| (?<thread>[^|]+) \| (?<logger>[^|]+)\s*\| (?<code>[^|]+) \| OpenTelemetry Message:\s*(?<otel_message>.*)$
    Time_Key timestamp
    Time_Format %Y-%m-%dT%H:%M:%S,%L
